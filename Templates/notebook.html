{% extends 'base.html' %}
{% block content %}
    <h2>{{ notebook.title }}</h2>

    <h3>Notes in this Notebook:</h3>
    <ul>
        {% if note %}
            {% for notes in note %}
            <li id="note-{{ notes.id }}">
                <p>{{ notes.content }}</p>
                {% if notes.doodle %}
                <img src="{{ notes.doodle }}" alt="Doodle" width="250">
                {% else %}
                <p> </p>
                {% endif %}
                <button type="button" onclick="editNote({{ notes.id }})">Edit Note</button>
                <form action="{{ url_for('delete_note', note_id=notes.id) }}" method="POST" style="display:inline;">
                    <button type="submit">Delete Note</button>
                </form>
                <div id="edit-form-{{ notes.id }}" style="display:none;">
                    <form action="{{ url_for('edit_note', note_id=notes.id) }}" method="POST">
                        <textarea name="note_content" rows="4" cols="50">{{ notes.content }}</textarea>
                        <input name="note_doodle" type="hidden" id="doodle-{{ notes.id }}" value="{{ notes.doodle }}">
                        
                        <h3>Edit Doodle:</h3>
                        <div id="edit-canvas-container-{{ notes.id }}">
                            <div id="canvas-controls-{{ notes.id }}">
                                <button type="button" id="undoButton-{{ notes.id }}">Undo</button>
                                <button type="button" id="eraserButton-{{ notes.id }}">Toggle Eraser</button>
                                <label for="colorPicker-{{ notes.id }}">Select Color:</label>
                                <input type="color" id="colorPicker-{{ notes.id }}" value="#000000">
                            </div>
                            <canvas id="edit-canvas-{{ notes.id }}" width="500" height="300" style="border:1px solid #000; cursor: crosshair;"></canvas>
                        </div>
                        
                        <button type="submit">Save Note</button>
                    </form>
                </div>
            </li>
            {% endfor %}
        {% else %}
            <li>No notes available.</li>
        {% endif %}
    </ul>

    <h3>Add a New Note:</h3>
    <form action="{{ url_for('add_note', notebook_id=notebook.id) }}" method="POST" onsubmit="return validateNote();">
        <textarea id="noteInput" name="note" placeholder="Add a new note..."></textarea>
        <input type="hidden" id="doodleInput" name="doodle">

        <h3>Doodle Area:</h3>
        <div id="canvas-container">
            <div id="canvas-controls">
                <button type="button" id="undoButton">Undo</button>
                <button type="button" id="eraserButton">Toggle Eraser</button>
                <label for="colorPicker">Select Color:</label>
                <input type="color" id="colorPicker" value="#000000">
            </div>
            <canvas id="canvas"></canvas>
        </div>

        <button type="submit">Add Note</button>
    </form>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
{% endblock %}